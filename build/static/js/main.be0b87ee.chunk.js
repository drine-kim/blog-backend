(this.webpackJsonpblog_frontend=this.webpackJsonpblog_frontend||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(17),i=n.n(c),s=n(8),o=n(2),u=n.n(o),l=n(5),d=n(4),j=n(0),b=function(e){var t=e.blog,n=e.handleLikeUpdate,a=e.handleDelete,c=Object(r.useState)(!1),i=Object(d.a)(c,2),s=i[0],o=i[1],u={paddingTop:7,paddingBottom:7,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},l={display:s?"":"none"};return Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{style:u,children:[t.title," ",Object(j.jsx)("button",{onClick:function(){return o(!s)},children:"view"})]}),Object(j.jsx)("div",{style:l,children:Object(j.jsxs)("div",{style:u,children:[t.title," ",Object(j.jsx)("button",{onClick:function(){return o(!s)},children:"hide"}),Object(j.jsx)("br",{}),t.url,Object(j.jsx)("br",{}),"likes ",t.likes," ",Object(j.jsx)("button",{onClick:n,id:"like-button",children:"like"}),Object(j.jsx)("br",{}),t.author,Object(j.jsx)("br",{}),Object(j.jsx)("button",{onClick:a,id:"delete-button",children:"delete"})]})})]})},p=n(6),h=n.n(p),f="/api/blogs",O=null,x={getAll:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get(f);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:O}},e.next=3,h.a.put("".concat(f,"/").concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deletee:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.delete("".concat(f,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="bearer ".concat(e)}},g={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=(n(42),function(e){return Object(j.jsx)("div",{children:Object(j.jsx)("p",{className:e.errorMessage?"showErrorMessage":"noneErrorMessage",children:e.errorMessage})})}),m=function(e){return Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:"Create New Blog"}),Object(j.jsxs)("form",{onSubmit:e.handleAddBlog,children:[Object(j.jsxs)("div",{children:["title",Object(j.jsx)("input",{type:"text",name:"title",value:e.title,onChange:function(t){return e.setTitle(t.target.value)}})]}),Object(j.jsxs)("div",{children:["author",Object(j.jsx)("input",{type:"text",name:"author",value:e.author,onChange:function(t){return e.setAuthor(t.target.value)}})]}),Object(j.jsxs)("div",{children:["url",Object(j.jsx)("input",{type:"text",name:"url",value:e.url,onChange:function(t){return e.setUrl(t.target.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"Create"})]})]})},w=function(e){var t=e.handleLogin,n=e.username,r=e.password,a=e.handleUsernameChange,c=e.handlePasswordChange;return Object(j.jsx)("div",{children:Object(j.jsxs)("form",{onSubmit:t,children:[Object(j.jsxs)("div",{children:["username",Object(j.jsx)("input",{type:"text",name:"username",id:"username",value:n,onChange:a})]}),Object(j.jsxs)("div",{children:["password",Object(j.jsx)("input",{type:"password",name:"password",id:"password",value:r,onChange:c})]}),Object(j.jsx)("button",{type:"submit",id:"button-login",children:"Login"})]})})},k=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(d.a)(n,2),c=a[0],i=a[1],s={display:c?"none":""},o={display:c?"":"none"},u=function(){i(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{style:s,children:Object(j.jsx)("button",{onClick:u,style:{marginBottom:"5px"},children:e.buttonText})}),Object(j.jsxs)("div",{style:o,children:[e.children,Object(j.jsx)("button",{onClick:u,children:"cancel "})]})]})})),y=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),i=Object(d.a)(c,2),o=i[0],p=i[1],h=Object(r.useState)(""),f=Object(d.a)(h,2),O=f[0],y=f[1],C=Object(r.useState)(""),S=Object(d.a)(C,2),T=S[0],A=S[1],B=Object(r.useState)(null),U=Object(d.a)(B,2),L=U[0],E=U[1],I=Object(r.useState)(""),M=Object(d.a)(I,2),D=M[0],J=M[1],N=Object(r.useState)(""),z=Object(d.a)(N,2),P=z[0],R=z[1],V=Object(r.useState)(""),_=Object(d.a)(V,2),H=_[0],W=_[1],Y=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.login({username:O,password:T});case 4:n=e.sent,E(n),x.setToken(n.token),window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(n)),y(""),A(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),p(e.t0.response.data.error),setTimeout((function(){p("")}),5e3);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),q=function(e){window.localStorage.removeItem("loggedBlogAppUser"),E(null)},F=function(e){e.preventDefault();var t={title:D,author:P,url:H,likes:0};K.current.toggleVisibility(),x.create(t).then((function(e){t.id=e.id,a(n.concat(t)),p("new blog is added"),setTimeout((function(){p("")}),5e3)})).catch((function(e){p(e.response.data.error),setTimeout((function(){p("")}),5e3)})),J(""),R(""),W("")},G=function(){var e=Object(l.a)(u.a.mark((function e(t){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.find((function(e){return e.id===t}));case 2:r=e.sent,c=Object(s.a)(Object(s.a)({},r),{},{likes:r.likes+1}),x.update(t,c).then((function(e){a(n.map((function(n){return n.id!==t?n:e}))),p("You liked this post ".concat(t)),setTimeout((function(){p("")}),5e3)})).catch((function(e){p(e.response.data.error),setTimeout((function(){p("")}),5e3)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=Object(r.useRef)();return Object(r.useEffect)((function(){x.getAll().then((function(e){e.sort((function(e,t){return t.likes-e.likes})),a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);E(t),x.setToken(t.token)}}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)(v,{errorMessage:o}),null===L?Object(j.jsx)(k,{buttonText:"login",children:Object(j.jsx)(w,{username:O,password:T,handleLogin:Y,handleUsernameChange:function(e){var t=e.target;return y(t.value)},handlePasswordChange:function(e){var t=e.target;return A(t.value)}})}):Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{children:"Blogs"}),Object(j.jsxs)("p",{children:[L.username," logged in ",Object(j.jsx)("button",{onClick:q,children:"Logout"})]}),Object(j.jsx)(k,{buttonText:"create blog",ref:K,children:Object(j.jsx)(m,{title:D,author:P,url:H,setTitle:J,setAuthor:R,setUrl:W,handleAddBlog:F})}),n.map((function(e){return Object(j.jsx)(b,{blog:e,handleLikeUpdate:function(){return G(e.id)},handleDelete:function(){return t=e.id,void(window.confirm("are you sure to delete")&&x.deletee(t).then((function(e){p("a blog is deleted"),setTimeout((function(){p("")}),5e3),a(n.filter((function(e){return e.id!==t})))})));var t}},e.id)}))]})]})};i.a.render(Object(j.jsx)(y,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.be0b87ee.chunk.js.map